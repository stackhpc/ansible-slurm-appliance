alertmanager_version: '0.28.1'
alertmanager_download_checksum: 'sha256:5ac7ab5e4b8ee5ce4d8fb0988f9cb275efcc3f181b4b408179fafee121693311'
alertmanager_download_dest: /tmp/alertmanager.tar.gz
alertmanager_binary_dir: /usr/local/bin
alertmanager_started: true
alertmanager_enabled: true

alertmanager_system_user: alertmanager
alertmanager_system_group: "{{ alertmanager_system_user }}"
alertmanager_config_file: /etc/alertmanager/alertmanager.yml # --config.file: Alertmanager configuration file name
alertmanager_storage_path: /var/lib/alertmanager # --storage.path: Base path for data storage

alertmanager_port: '9093'
alertmanager_web_listen_addresses:
  - ":{{ alertmanager_port }}"
alertmanager_web_external_url: "http://localhost:{{ alertmanager_port}}/" # TODO: is this right??

alertmanager_data_retention: '120h'
alertmanager_data_maintenance_interval: '15m'
alertmanager_config_flags: {} # other command-line parameters as shown by `man alertmanager`
alertmanager_config_template: alertmanager.yml.j2

# everything below here is interpolated into alertmanager_config_default:

# Uncomment below and add Slack bot app creds for Slack integration
# alertmanager_slack_integration:
#   channel: '#alerts'
#   app_creds:

alertmanager_null_receiver:
  name: 'null'
alertmanager_slack_receiver: {} # defined in common env as it needs prometheus_address
alertmanager_extra_receivers: []
alertmanager_default_receivers: "{{ [alertmanager_null_receiver] + ([alertmanager_slack_receiver] if alertmanager_slack_integration is defined else []) }}"
alertmanager_receivers: "{{ alertmanager_default_receivers  + alertmanager_extra_receivers }}"

alertmanager_config_default:
  route:
    group_by: ['...']
    receiver: "{{ 'slack-receiver' if alertmanager_slack_integration is defined else 'null' }}"
  receivers: "{{ alertmanager_receivers }}"

alertmanager_config_extra: {} # top-level only
