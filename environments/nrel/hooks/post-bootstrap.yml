# TODO: KBENDL - check compatibility with new playbook

- name: Set timezone
  hosts: all
  become: true
  tasks:
  - name: Set timezone to Americas/Denver
    timezone:
      name: America/Denver
  - include_role:
      name: aco.core.ntp
    tags:
      - vs_all_nodes_timezone

- name: "NREL pre - Mount cephfs volumes"
  hosts: ceph:!builder
  tags:
    - vs_pre
    - aco.core.cephfs
  become: true
  tasks:
    - name: Does ceph exist?
      ansible.builtin.stat:
        path: /etc/ceph
      register: vs_does_cephdir
    - name: CephFS now
      ansible.builtin.include_role:
        name: aco.core.cephfs
      tags:
        - aco.core.cephfs
      when: not vs_does_cephdir.stat.exists
    - name: Tmp umount /home
      ansible.builtin.shell: systemctl stop home.mount
      when: not vs_does_cephdir.stat.exists
      become: true
