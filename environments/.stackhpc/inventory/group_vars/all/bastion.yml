repo_ci_cloud: "{{ lookup('env', 'CI_CLOUD') }}" # repo variable
# get e.g. LEAFCLOUD from CI_CLOUD=LEAFCLOUD label, only (possibly) set on PRs:
pr_cloud: "{{ lookup('env', 'PR_LABELS') | split(',') | select('match', 'CI_CLOUD') | first | default('') | split('=') | last }}"
ci_cloud: "{{ pr_cloud or repo_ci_cloud }}" # so PR labels win
bastion_config:
  ARCUS:
    user: slurm-app-ci
    ip: 128.232.222.183
  LEAFCLOUD:
    user: rocky
    ip: 195.114.30.222
# NB: The bastion_{user,ip} variables are used directly in the CI workflow too
bastion_user: "{{ bastion_config[ci_cloud].user }}"
bastion_ip: "{{ bastion_config[ci_cloud].ip }}"
ansible_ssh_common_args: '-o ProxyCommand="ssh {{ bastion_user }}@{{ bastion_ip }} -W %h:%p"'
