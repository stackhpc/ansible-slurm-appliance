# See ansible/roles/firewalld/README.md
# for variable definitions.

firewalld_configs_default:
  # A list of dicts defining firewalld rules to be applied to the fail2ban node.
  # Each dict contains:
  #   name: An arbitrary name or description
  #   group: An ansible group name - this rule is applied if the fail2ban node is in this group
  #   rule: A dict of parameters passed to the `ansible.posix.firewalld` module.
  - name: Enable all ports within openhpc cluster
    group: openhpc
    rule:
      source:  "{{ cluster_subnet_cidr }}"
      zone: trusted
      state: enabled
      permanent: yes
  - name: Allow https for openondemand
    group: openondemand
    rule:
      service: https
      zone: public
      state: enabled
      permanent: yes
  # - name: Disable cockpit service
  #   group: cluster # 'all' is never in group_names
  #   rule:
  #     service: cockpit
  #     zone: public
  #     state: disabled
  #     permanent: yes

firewalld_configs_extra: [] # list of dicts with parameters as for firewalld_configs_default

firewalld_configs: "{{ (firewalld_configs_default + firewalld_configs_extra) | selectattr('group', 'in',  group_names) | map(attribute='rule') }}"
